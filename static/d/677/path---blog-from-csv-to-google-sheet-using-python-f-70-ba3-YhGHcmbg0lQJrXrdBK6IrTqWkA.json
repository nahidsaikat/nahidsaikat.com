{"data":{"markdownRemark":{"id":"b4f38bf0-a195-587b-b628-c79e14a3416f","html":"<p><img src=\"/media/csv_to_google_sheet.jpg\" alt=\"From CSV to Google Sheet Using Python\" title=\"From CSV to Google Sheet Using Python\"></p>\n<p>Recently I have written a Python script for my Manager. The purpose the  script was to read some JSON data, apply some business rules on them, generate a CSV(Comma Separated Value) file and upload it in a Google Spread Sheet. The sheet helped my manager to get insight of the JSON data so that he can take action based on it.</p>\n<p>The JSON data and business rules of the script are very specific for my manager. But the way I managed to import the generated CSV file to Google Sheet is very generic. So what I have decided is that I will write an article on how I have uploaded the CSV file to Google Spread Sheet and this article is the result of it.</p>\n<p>In that Python script I have used a library called <a href=\"https://gspread.readthedocs.io/en/latest/\" title=\"gspread\">gspread</a>. gspread is a Python API for Google Sheets. It’s a very good Python library for interacting with Google Sheet as it is very simple and straight forward.</p>\n<!-- OK enough talk, lets dive deep into the way I have managed to upload a CSV file into Google Spread Sheet. -->\n<p>For interacting with Google Sheet API first thing we have to do is create a project in <a href=\"https://console.developers.google.com/%20,\" title=\"Google Developers Console\">Google Developers Console</a> and enable some APIs. To do that just follow the steps below.</p>\n<ol>\n<li>Click on <a href=\"https://console.developers.google.com/cloud-resource-manager,\" title=\"Google Developers Console\">this link</a> to create a project.</li>\n</ol>\n<p><img src=\"/media/google_sheet/0_create_project.jpg\" alt=\"Create Google Project\" title=\"Create Google Project\"></p>\n<ol start=\"2\">\n<li>Give the project a name.</li>\n</ol>\n<p><img src=\"/media/google_sheet/1_project_name.jpg\" alt=\"Create Google Project\" title=\"Create Google Project\"></p>\n<ol start=\"3\">\n<li>Go to project dashboard and click on <strong>  + ENABLE APIS AND SERVICES</strong>.</li>\n</ol>\n<p><img src=\"/media/google_sheet/2_enable_apis.jpg\" alt=\"Create Google Project\" title=\"Create Google Project\"></p>\n<ol start=\"4\">\n<li>Search for <strong>Google Drive API</strong> and click on it.</li>\n</ol>\n<p><img src=\"/media/google_sheet/3_search_drive_api.jpg\" alt=\"Create Google Project\" title=\"Create Google Project\"></p>\n<ol start=\"5\">\n<li>Enable Google Drive API.</li>\n</ol>\n<p><img src=\"/media/google_sheet/4_enable_drive_api.jpg\" alt=\"Create Google Project\" title=\"Create Google Project\"></p>\n<ol start=\"6\">\n<li>Click on <strong>Create Credentials</strong>.</li>\n</ol>\n<p><img src=\"/media/google_sheet/5_create_credentials.jpg\" alt=\"Create Google Project\" title=\"Create Google Project\"></p>\n<ol start=\"7\">\n<li>Select the parameters and click on <strong>What credentials do I need?</strong>.</li>\n</ol>\n<p><img src=\"/media/google_sheet/6_credential_type.jpg\" alt=\"Create Google Project\" title=\"Create Google Project\"></p>\n<ol start=\"8\">\n<li>Enter a Service Account Name and select Role.</li>\n</ol>\n<p><img src=\"/media/google_sheet/7_get_credential_json.jpg\" alt=\"Create Google Project\" title=\"Create Google Project\"></p>\n<p>A JSON file will be downloaded. We will need this JSON file in our script. So rename that file as <code class=\"language-text\">client_secret.json</code>. The content of the JSON file is as following.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"service_account\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"project_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"focus-zxzxzx-******\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"private_key_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"****************************************\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"private_key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"-----BEGIN PRIVATE KEY-----\\n***private_key***\\n-----END PRIVATE KEY-----\\n\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"client_email\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"google-sheet-demo@focus-zxzxzx-******.iam.gserviceaccount.com\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"client_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"************************\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"auth_uri\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://accounts.google.com/o/oauth2/auth\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"token_uri\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://oauth2.googleapis.com/token\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"auth_provider_x509_cert_url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://www.googleapis.com/oauth2/v1/certs\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"client_x509_cert_url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://www.googleapis.com/robot/v1/metadata/x509/google-sheet-demo%40focus-zxzxzx-******.iam.gserviceaccount.com\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now go to your Google Drive and create an Google Sheet and name it “CSV-to-Google-Sheet”. Copy <code class=\"language-text\">client_email</code> value from the JSON file you have downloaded above and share that Google Sheet to this <code class=\"language-text\">client_email</code> with edit permission like the image below.</p>\n<p><img src=\"/media/google_sheet/8_share_sheet.jpg\" alt=\"Create Google Project\" title=\"Create Google Project\"></p>\n<p>At this point we have everything set up, so lets write our Python script to upload a CSV file in the Google Sheet. For this purpose we have to install gspread Python library. So open up the terminal and run the following commands.</p>\n<div class=\"gatsby-highlight\" data-language=\"cmd\"><pre class=\"language-cmd\"><code class=\"language-cmd\">pip install gspread\npip install oauth2client</code></pre></div>\n<p>Now create a Python file and name it <strong>upload.py</strong>. Copy and paster the following code in it.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> gspread\n<span class=\"token keyword\">from</span> oauth2client<span class=\"token punctuation\">.</span>service_account <span class=\"token keyword\">import</span> ServiceAccountCredentials\n\nscope <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"https://spreadsheets.google.com/feeds\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://www.googleapis.com/auth/spreadsheets'</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"https://www.googleapis.com/auth/drive.file\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"https://www.googleapis.com/auth/drive\"</span><span class=\"token punctuation\">]</span>\n\ncredentials <span class=\"token operator\">=</span> ServiceAccountCredentials<span class=\"token punctuation\">.</span>from_json_keyfile_name<span class=\"token punctuation\">(</span><span class=\"token string\">'client_secret.json'</span><span class=\"token punctuation\">,</span> scope<span class=\"token punctuation\">)</span>\nclient <span class=\"token operator\">=</span> gspread<span class=\"token punctuation\">.</span>authorize<span class=\"token punctuation\">(</span>credentials<span class=\"token punctuation\">)</span>\n\nspreadsheet <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'CSV-to-Google-Sheet'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data.csv'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> file_obj<span class=\"token punctuation\">:</span>\n    content <span class=\"token operator\">=</span> file_obj<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    client<span class=\"token punctuation\">.</span>import_csv<span class=\"token punctuation\">(</span>spreadsheet<span class=\"token punctuation\">.</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>content<span class=\"token punctuation\">)</span></code></pre></div>\n<p>What we are doing here is import <strong>gspread</strong> and <strong>ServiceAccountCredentials</strong>, then we defined the scope and load the credentials from the JSON file we have download above. Then we are authorizing with the credentials and getting client object. We are using that client object to open the Google Sheet <strong>CSV-to-Google-Sheet</strong>. Finally we are reading the CSV file using <strong>open</strong> built-in function of Python and importing it to the Google Sheet by that client object. </p>\n<p>Now run the Python script with this command <code class=\"language-text\">python upload.py</code> and open <strong>CSV-to-Google-Sheet</strong> Google Sheet in your browser. You will see that your Google Sheet is updated with the content of the CSV file as following.</p>\n<p><img src=\"/media/google_sheet/9_after_upload.jpg\" alt=\"Create Google Project\" title=\"Create Google Project\"></p>\n<p>You can do more stuff with Google Sheet using gspread library. Checkout there <a href=\"https://gspread.readthedocs.io/en/latest/\" title=\"gspread\">documentation</a> to learn more.</p>\n<p>The complete code of this article can be found in <a href=\"https://github.com/nahidsaikat/CSV-to-Google-Sheet\" title=\"GitHub\">this repository</a>.</p>","fields":{"slug":"/blog/from-csv-to-google-sheet-using-python/","tagSlugs":["/tag/google/","/tag/spread-sheet/"]},"frontmatter":{"date":"2020-04-12T00:12:03.284Z","description":"Upload a CSV file to Google Spread Sheet using python. In this article we have used a Python library gspread. gspread is a Python API for Google Sheets.","tags":["Google","Spread Sheet"],"title":"From CSV to Google Sheet Using Python"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/from-csv-to-google-sheet-using-python/"}}